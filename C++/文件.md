# 文件

## 流

| 文件指针 | 流         | 含义         |
| -------- | ---------- | ------------ |
| stdin    | 标准输入流 | 使用键盘输入 |
| stdout   | 标准输出流 | 输出到屏幕上 |

## 文件指针

类型为```FILE *```



### 使用方法

**FILE *变量**

``FILE *fp``

## 文件操作

### 打开文件

使用```fopen```函数

####用法：

```c
FILE *fp=fopen("路径","模式")
```

路径中如果包含``\``时，默认在字符串里将被当作转义字符的开头对待，可以写成``\\``或者``/``

**例如**

要打开``C:\mingw64\build-info.txt``文件时，可写为``C:\\mingw64\\build-info.txt``或者``C:/mingw64/build-info.txt``

#### 模式

针对文本文件

| 字符串 | 含义                                                         |
| :----: | :----------------------------------------------------------- |
|   r    | 仅读取                                                       |
|   w    | 写入文件，若文件不存在则自动创建，如果存在，则(从头，即当前位置)直接替换全部内容 |
|   a    | 追加文本，默认是追加到尾部，若文件不存在，则自动创建         |
|   r+   | 读写，从头部开始替换，文件不存在不会自动创建                 |
|   w+   | 用于读写，若文件存在则替换全部内容，不存在则自动创建         |
|   a+   | 用于读写，若文件存在就追加到尾部，若不存在则创建             |

#####r+的替换

若之前文件内容为

```
123456789
```

执行下列代码

```c
FILE *fp=fopen("1.txt","r+");
fprintf(fp,"99999");
```

之后，文件内容将变成

```
999996789
```

使用**r+  w+   a+**进行文件读写时尽量只执行其中的一项，及仅读或者仅写，因为文件指针会来回变化的，读写文件后，文件内的流指针会停在当前位置。

针对一上问题，有两种解决办法。

第一种 重新打开文件

第二种 使用文件定位函数

#### 文件定位

#### seek

调用形式```fseek(流,字节数,位置)```

**字节数**为来回推进的字节数，负数代表往回(左)推进的字节数，正数代表往前(右)推进的字节数。

**位置**为从哪个位置进行推进，通常有三种类型

|   类型   |   说明   |
| :------: | :------: |
| SEEK_SET |  起始处  |
| SEEK_CUR | 当前位置 |
| SEEK_END |  末尾处  |

返回到头部可写为```fseek(fp,0L,SEEK_SET)```

转到尾部可以写为```fseek(fp,0L,SEEK_END)```

#### rewind

将文件指针返回到头部

用法```rewind(fp)```

等价于```fseek(fp,0L,SEEK_SET)```

#### 关闭文件

```fclose(fp)```

## 输入输出

### 输入

#### fscanf

可以在文件/标准输入流**stdin**中读入

格式```fscanf(流,"格式",接收变量)```

流可以设置为文件，当设置为**stdin**时，作用效果与scanf一致

----

#### fgets

可在文件/标准输入流中读入，可以解决gets不安全问题

格式```fgets(变量,字节数,流)```

```c
fgets(str,sizeof(str),stdin);
```

当遇到换行或者已经读入的字符达到``sizeof(str)``-1个字符时将停止读入

----

#### fgetc

可在文件/标准输入流中读入

格式```变量=getc(流)```

当``流``为``stdin``时效果与```getchar()```一致

----



### 输出

#### fprintf

格式```fprintf(流,"格式",变量)```

流可以设置为文件，当设置为**stdout**时，作用效果与```printf```一致

-----

#### fputs

格式```fputs("内容"/字符变量,流)```

当流为```stdout```时，与```puts```效果一致

-----

#### fputc

格式```fputc(变量/'字符',流)```

当流为``stdout``时，与``putchar``效果一致